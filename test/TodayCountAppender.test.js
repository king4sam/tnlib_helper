import LibHost from 'script/TodayCountAppender.js';
const chrome = require('sinon-chrome/extensions');
var sinon = require('sinon');


describe("TodayCountAppender.js", () => {
  let libhost, target, bookstub, locationstub,now;
  beforeEach(() => {
    libhost = new LibHost('http://163.26.71.106/toread/');

    target = htmlToElements(booktable);

    bookstub = sinon.stub(document, "querySelectorAll");
    bookstub.returns(target);

    var thatday = new Date('2018/06/17')
    now = sinon.useFakeTimers(thatday.getTime());

    locationstub = sinon.stub(libhost, "getlocation");
    locationstub.returns('http://163.26.71.106/toread/circulation/exttransit/TransitItemsToBeReceived,popupComponent.hiddenPopupButton.html');
  })

  afterEach(() => {
    bookstub.restore();
    locationstub.restore();
    now.restore();
  })

  it("should calculate today borrow count", () => {
    let ans = libhost.getBorrowCount();

    expect(ans).toBe(3)
  });

})

function htmlToElements(html) {
    var template = document.createElement('template');
    template.innerHTML = html;
    return template.content.childNodes;
}

var booktable = `<tr><td></td><td></td><td align="center"><b>交易類型</b></td><td align="center"><a id="DirectLink_11" class="simple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink.sdirect?sp=SITEM_NUMBER&amp;sp=ca" onclick="return tapestry.linkOnClick(this.href,'DirectLink_11', false)"><b>條碼號</b></a></td><td align="center"><a id="DirectLink_12" class="simple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_0.sdirect?sp=SMATERIL_TYPE&amp;sp=ca" onclick="return tapestry.linkOnClick(this.href,'DirectLink_12', false)"><b>資料類型</b></a></td><td align="center"><a id="DirectLink_13" class="simple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_1.sdirect?sp=SCALL_NUMBER&amp;sp=ca" onclick="return tapestry.linkOnClick(this.href,'DirectLink_13', false)"><b>索書號</b></a></td><td align="center"><a id="DirectLink_14" class="simple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_2.sdirect?sp=SLOCATION&amp;sp=ca" onclick="return tapestry.linkOnClick(this.href,'DirectLink_14', false)"><b>館藏地</b></a></td><td align="center"><a id="DirectLink_15" class="simple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_3.sdirect?sp=SPICKUP_LOCATION&amp;sp=ca" onclick="return tapestry.linkOnClick(this.href,'DirectLink_15', false)"><b>取書館別</b></a></td><td align="center"><a id="DirectLink_16" class="simple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_4.sdirect?sp=STITLE&amp;sp=ca" onclick="return tapestry.linkOnClick(this.href,'DirectLink_16', false)"><b>書名</b></a></td><td style="padding: 3px;" align="center"><a id="DirectLink_17" class="simple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_5.sdirect?sp=SOPEN_DATE&amp;sp=ca" onclick="return tapestry.linkOnClick(this.href,'DirectLink_17', false)"><b>借閱日期</b></a></td><td align="center"><a id="DirectLink_18" class="simple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_6.sdirect?sp=SDUE_DATE&amp;sp=ca" onclick="return tapestry.linkOnClick(this.href,'DirectLink_18', false)"><b>到期日期</b></a></td><td align="center"><a id="DirectLink_19" class="simple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_7.sdirect?sp=SCLOSE_DATE&amp;sp=ca" onclick="return tapestry.linkOnClick(this.href,'DirectLink_19', false)"><b>還書日期</b></a></td><td align="center"><b>註記</b></td><td align="center"><b>結束方式</b></td><td align="center"></td></tr><tr height="20" style="color: black;" id="Any_9_1"><td class="black">1<strong>.</strong></td><td align="center"><input id="60456694" type="checkbox"></td><td align="center"><a id="DirectLink_20" title="Edit transaction" onclick="return createPopEdit(this.href);" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_8.sdirect?sp=l60456694">Borrow-day</a></td><td align="left"><a id="DirectLink_21" title="Circulation note" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_13.sdirect?sp=SED0084166&amp;updateParts=itemCircNoteDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_21', false)">ED0084166</a></td><td align="left">中文書</td><td align="left">528.923 8437 2013</td><td align="left">安定開架閱覽區[ED_B]</td><td align="center"></td><td align="left" width="110px"><span title="肌力訓練圖解聖經 /DK Publishing作 ; 許育達等譯.臺北市 :旗標,2011." style="color: blue;" id="Insert_24_0">肌力訓練圖解聖經 /</span></td><td align="center" width="110px">2018-05-18 10:15:00</td><td align="center" width="110px">2018-07-11 23:59:59</td><td align="center" width="110px"></td><td align="center" width="110px"></td><td align="center"></td><td align="center">(1)<a id="DirectLink_22" title="續借" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_14.sdirect?sp=l60456694" onclick="return tapestry.linkOnClick(this.href,'DirectLink_22', false)"><img src="/toread/images/renew.gif" border="0" id="Any_11_0"></a><a id="DirectLink_23" title="還書" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_15.sdirect?sp=l60456694" onclick="return tapestry.linkOnClick(this.href,'DirectLink_23', false)"><img src="/toread/images/checkin.gif" border="0" id="Any_12_0"></a><a id="DirectLink_24" title="設定遺失或聲稱已還" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_16.sdirect?sp=l60456694&amp;updateParts=itemLostDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_24', false)"><img src="/toread/images/lost_claim.gif" border="0" id="Any_13_0"></a></td></tr><tr height="20" style="color: black;" id="Any_9_2"><td class="black">2<strong>.</strong></td><td align="center"><input id="61277699" type="checkbox"></td><td align="center"><a id="DirectLink_25" title="Edit transaction" onclick="return createPopEdit(this.href);" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_8.sdirect?sp=l61277699">Borrow-day</a></td><td align="left"><a id="DirectLink_26" title="Circulation note" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_13.sdirect?sp=SED0092197&amp;updateParts=itemCircNoteDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_26', false)">ED0092197</a></td><td align="left">中文書</td><td align="left">857.7 8345 2014</td><td align="left">安定罕用書庫(需線上調閱)[ED_HSO]</td><td align="center"></td><td align="left" width="110px"><span title="黃色小說 =Blue fiction /黃崇凱作新北市 :木馬文化出版 :2014" style="color: blue;" id="Insert_24_1">黃色小說 =</span></td><td align="center" width="110px">2018-06-13 00:32:41</td><td align="center" width="110px">2018-07-11 23:59:59</td><td align="center" width="110px"></td><td align="center" width="110px"></td><td align="center"></td><td align="center">(0)<a id="DirectLink_27" title="續借" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_14.sdirect?sp=l61277699" onclick="return tapestry.linkOnClick(this.href,'DirectLink_27', false)"><img src="/toread/images/renew.gif" border="0" id="Any_11_1"></a><a id="DirectLink_28" title="還書" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_15.sdirect?sp=l61277699" onclick="return tapestry.linkOnClick(this.href,'DirectLink_28', false)"><img src="/toread/images/checkin.gif" border="0" id="Any_12_1"></a><a id="DirectLink_29" title="設定遺失或聲稱已還" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_16.sdirect?sp=l61277699&amp;updateParts=itemLostDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_29', false)"><img src="/toread/images/lost_claim.gif" border="0" id="Any_13_1"></a></td></tr><tr height="20" style="color: black;" id="Any_9_3"><td class="black">3<strong>.</strong></td><td align="center"><input id="61277704" type="checkbox"></td><td align="center"><a id="DirectLink_30" title="Edit transaction" onclick="return createPopEdit(this.href);" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_8.sdirect?sp=l61277704">Borrow-day</a></td><td align="left"><a id="DirectLink_31" title="Circulation note" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_13.sdirect?sp=SED0109129&amp;updateParts=itemCircNoteDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_31', false)">ED0109129</a></td><td align="left">中文書</td><td align="left">550.1657 8834 2013</td><td align="left">安定開架閱覽區[ED_B]</td><td align="center"></td><td align="left" width="110px"><span title="國家為什麼會失敗 :權力、富裕與貧困的根源 /戴倫.艾塞默魯(Daron Acemoglu), 詹姆斯.羅賓森(James A. Robinson)著 ; 吳國卿, 鄧伯宸譯[新北市] :衛城出版,2013" style="color: blue;" id="Insert_24_2">國家為什麼會失敗 :</span></td><td align="center" width="110px">2018-06-13 00:36:23</td><td align="center" width="110px">2018-07-17 23:59:59</td><td align="center" width="110px"></td><td align="center" width="110px"></td><td align="center"></td><td align="center">(1)<a id="DirectLink_32" title="續借" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_14.sdirect?sp=l61277704" onclick="return tapestry.linkOnClick(this.href,'DirectLink_32', false)"><img src="/toread/images/renew.gif" border="0" id="Any_11_2"></a><a id="DirectLink_33" title="還書" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_15.sdirect?sp=l61277704" onclick="return tapestry.linkOnClick(this.href,'DirectLink_33', false)"><img src="/toread/images/checkin.gif" border="0" id="Any_12_2"></a><a id="DirectLink_34" title="設定遺失或聲稱已還" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_16.sdirect?sp=l61277704&amp;updateParts=itemLostDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_34', false)"><img src="/toread/images/lost_claim.gif" border="0" id="Any_13_2"></a></td></tr><tr height="20" style="color: black;" id="Any_9_4"><td class="black">4<strong>.</strong></td><td align="center"><input id="61277706" type="checkbox"></td><td align="center"><a id="DirectLink_35" title="Edit transaction" onclick="return createPopEdit(this.href);" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_8.sdirect?sp=l61277706">Borrow-day</a></td><td align="left"><a id="DirectLink_36" title="Circulation note" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_13.sdirect?sp=SED0085062&amp;updateParts=itemCircNoteDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_36', false)">ED0085062</a></td><td align="left">中文書</td><td align="left">198.57 8753 c.1</td><td align="left">安定罕用書庫(需線上調閱)[ED_HSO]</td><td align="center"></td><td align="left" width="110px"><span title="正義 :一場思辨之旅 /邁可.桑德爾(Michael J. Sandel)著 ; 樂為良譯[臺北市] :雅言文化出版 :2011.03" style="color: blue;" id="Insert_24_3">正義 :</span></td><td align="center" width="110px">2018-06-13 00:37:02</td><td align="center" width="110px">2018-07-11 23:59:59</td><td align="center" width="110px"></td><td align="center" width="110px"></td><td align="center"></td><td align="center">(0)<a id="DirectLink_37" title="續借" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_14.sdirect?sp=l61277706" onclick="return tapestry.linkOnClick(this.href,'DirectLink_37', false)"><img src="/toread/images/renew.gif" border="0" id="Any_11_3"></a><a id="DirectLink_38" title="還書" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_15.sdirect?sp=l61277706" onclick="return tapestry.linkOnClick(this.href,'DirectLink_38', false)"><img src="/toread/images/checkin.gif" border="0" id="Any_12_3"></a><a id="DirectLink_39" title="設定遺失或聲稱已還" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_16.sdirect?sp=l61277706&amp;updateParts=itemLostDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_39', false)"><img src="/toread/images/lost_claim.gif" border="0" id="Any_13_3"></a></td></tr><tr height="20" style="color: black;" id="Any_9_5"><td class="black">5<strong>.</strong></td><td align="center"><input id="61440434" type="checkbox"></td><td align="center"><a id="DirectLink_40" title="Edit transaction" onclick="return createPopEdit(this.href);" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_8.sdirect?sp=l61440434">Borrow-day</a></td><td align="left"><a id="DirectLink_41" title="Circulation note" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_13.sdirect?sp=SED0041473&amp;updateParts=itemCircNoteDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_41', false)">ED0041473</a></td><td align="left">中文書</td><td align="left">952.2 8474</td><td align="left">安定開架閱覽區[ED_B]</td><td align="center"></td><td align="left" width="110px"><span title="這樣取景構圖才漂亮! :專業攝影師傳授的構圖技巧 /鄭承盛著 ; 蔡家燕,博碩文化編譯.臺北縣汐止市 :博碩文化,2008[民97]" style="color: blue;" id="Insert_24_4">這樣取景構圖才漂亮! :</span></td><td align="center" width="110px">2018-06-17 14:10:10</td><td align="center" width="110px">2018-07-15 23:59:59</td><td align="center" width="110px"></td><td align="center" width="110px"></td><td align="center"></td><td align="center">(0)<a id="DirectLink_42" title="續借" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_14.sdirect?sp=l61440434" onclick="return tapestry.linkOnClick(this.href,'DirectLink_42', false)"><img src="/toread/images/renew.gif" border="0" id="Any_11_4"></a><a id="DirectLink_43" title="還書" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_15.sdirect?sp=l61440434" onclick="return tapestry.linkOnClick(this.href,'DirectLink_43', false)"><img src="/toread/images/checkin.gif" border="0" id="Any_12_4"></a><a id="DirectLink_44" title="設定遺失或聲稱已還" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_16.sdirect?sp=l61440434&amp;updateParts=itemLostDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_44', false)"><img src="/toread/images/lost_claim.gif" border="0" id="Any_13_4"></a></td></tr><tr height="20" style="color: black;" id="Any_9_6"><td class="black">6<strong>.</strong></td><td align="center"><input id="61440440" type="checkbox"></td><td align="center"><a id="DirectLink_45" title="Edit transaction" onclick="return createPopEdit(this.href);" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_8.sdirect?sp=l61440440">Borrow-day</a></td><td align="left"><a id="DirectLink_46" title="Circulation note" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_13.sdirect?sp=SED0087439&amp;updateParts=itemCircNoteDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_46', false)">ED0087439</a></td><td align="left">中文書</td><td align="left">952.2 8957 2014</td><td align="left">安定開架閱覽區[ED_B]</td><td align="center"></td><td align="left" width="110px"><span title="DSLR構圖寶典 :數位攝影的黃金法則 /布萊恩.彼得森(Byran Peterson)著 ; 韓筠青譯臺北市 :旗標,2014.02" style="color: blue;" id="Insert_24_5">DSLR構圖寶典 :</span></td><td align="center" width="110px">2018-06-17 14:10:14</td><td align="center" width="110px">2018-07-15 23:59:59</td><td align="center" width="110px"></td><td align="center" width="110px"></td><td align="center"></td><td align="center">(0)<a id="DirectLink_47" title="續借" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_14.sdirect?sp=l61440440" onclick="return tapestry.linkOnClick(this.href,'DirectLink_47', false)"><img src="/toread/images/renew.gif" border="0" id="Any_11_5"></a><a id="DirectLink_48" title="還書" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_15.sdirect?sp=l61440440" onclick="return tapestry.linkOnClick(this.href,'DirectLink_48', false)"><img src="/toread/images/checkin.gif" border="0" id="Any_12_5"></a><a id="DirectLink_49" title="設定遺失或聲稱已還" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_16.sdirect?sp=l61440440&amp;updateParts=itemLostDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_49', false)"><img src="/toread/images/lost_claim.gif" border="0" id="Any_13_5"></a></td></tr><tr height="20" style="color: black;" id="Any_9_7"><td class="black">7<strong>.</strong></td><td align="center"><input id="61440450" type="checkbox"></td><td align="center"><a id="DirectLink_50" title="Edit transaction" onclick="return createPopEdit(this.href);" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_8.sdirect?sp=l61440450">Borrow-day</a></td><td align="left"><a id="DirectLink_51" title="Circulation note" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_13.sdirect?sp=SED0107723&amp;updateParts=itemCircNoteDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_51', false)">ED0107723</a></td><td align="left">中文書</td><td align="left">953.1 847 2016</td><td align="left">安定開架閱覽區[ED_B]</td><td align="center"></td><td align="left" width="110px"><span title="攝影必修寶典 :經典風景攝影 /Fun視覺作臺北市 :上奇資訊,2016.08" style="color: blue;" id="Insert_24_6">攝影必修寶典 :</span></td><td align="center" width="110px">2018-06-17 14:10:23</td><td align="center" width="110px">2018-07-15 23:59:59</td><td align="center" width="110px"></td><td align="center" width="110px"></td><td align="center"></td><td align="center">(0)<a id="DirectLink_52" title="續借" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_14.sdirect?sp=l61440450" onclick="return tapestry.linkOnClick(this.href,'DirectLink_52', false)"><img src="/toread/images/renew.gif" border="0" id="Any_11_6"></a><a id="DirectLink_53" title="還書" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_15.sdirect?sp=l61440450" onclick="return tapestry.linkOnClick(this.href,'DirectLink_53', false)"><img src="/toread/images/checkin.gif" border="0" id="Any_12_6"></a><a id="DirectLink_54" title="設定遺失或聲稱已還" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_16.sdirect?sp=l61440450&amp;updateParts=itemLostDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_54', false)"><img src="/toread/images/lost_claim.gif" border="0" id="Any_13_6"></a></td></tr><tr height="20" style="color: black;" id="Any_9_8"><td class="black">8<strong>.</strong></td><td align="center"><input id="61703501" type="checkbox"></td><td align="center"><a id="DirectLink_55" title="Edit transaction" onclick="return createPopEdit(this.href);" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_8.sdirect?sp=l61703501">Borrow-day</a></td><td align="left"><a id="DirectLink_56" title="Circulation note" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_13.sdirect?sp=SED0096117&amp;updateParts=itemCircNoteDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_56', false)">ED0096117</a></td><td align="left">中文書</td><td align="left">874.57 857 2014</td><td align="left">安定開架閱覽區[ED_B]</td><td align="center"></td><td align="left" width="110px"><span title="控制 /吉莉安.弗琳(Gillian Flynn)著 ; 施清真譯臺北市 :時報文化,2014.09" style="color: blue;" id="Insert_24_7">控制 /</span></td><td align="center" width="110px">2018-06-26 13:11:04</td><td align="center" width="110px">2018-07-24 23:59:59</td><td align="center" width="110px"></td><td align="center" width="110px"></td><td align="center"></td><td align="center">(0)<a id="DirectLink_57" title="續借" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_14.sdirect?sp=l61703501" onclick="return tapestry.linkOnClick(this.href,'DirectLink_57', false)"><img src="/toread/images/renew.gif" border="0" id="Any_11_7"></a><a id="DirectLink_58" title="還書" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_15.sdirect?sp=l61703501" onclick="return tapestry.linkOnClick(this.href,'DirectLink_58', false)"><img src="/toread/images/checkin.gif" border="0" id="Any_12_7"></a><a id="DirectLink_59" title="設定遺失或聲稱已還" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_16.sdirect?sp=l61703501&amp;updateParts=itemLostDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_59', false)"><img src="/toread/images/lost_claim.gif" border="0" id="Any_13_7"></a></td></tr><tr height="20" style="color: black;" id="Any_9_9"><td class="black">9<strong>.</strong></td><td align="center"><input id="61962272" type="checkbox"></td><td align="center"><a id="DirectLink_60" title="Edit transaction" onclick="return createPopEdit(this.href);" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_8.sdirect?sp=l61962272">Borrow-day</a></td><td align="left"><a id="DirectLink_61" title="Circulation note" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_13.sdirect?sp=SED0123243&amp;updateParts=itemCircNoteDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_61', false)">ED0123243</a></td><td align="left">中文書</td><td align="left">318.1 8459 2017</td><td align="left">安定開架閱覽區[ED_B]</td><td align="center"></td><td align="left" width="110px"><span title="演算法圖鑑 :26種演算法+7種資料結構, 人工智慧.數據分析.邏輯思考的原理和應用全圖解 = Algorithms : explained and illustrated /石田保輝, 宮崎修一著 ; 陳彩華譯臺北市 :臉譜出版 :2017.12" style="color: blue;" id="Insert_24_8">演算法圖鑑 :</span></td><td align="center" width="110px">2018-07-03 14:10:24</td><td align="center" width="110px">2018-07-17 23:59:59</td><td align="center" width="110px"></td><td align="center" width="110px"></td><td align="center"></td><td align="center">(0)<a id="DirectLink_62" title="續借" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_14.sdirect?sp=l61962272" onclick="return tapestry.linkOnClick(this.href,'DirectLink_62', false)"><img src="/toread/images/renew.gif" border="0" id="Any_11_8"></a><a id="DirectLink_63" title="還書" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_15.sdirect?sp=l61962272" onclick="return tapestry.linkOnClick(this.href,'DirectLink_63', false)"><img src="/toread/images/checkin.gif" border="0" id="Any_12_8"></a><a id="DirectLink_64" title="設定遺失或聲稱已還" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_16.sdirect?sp=l61962272&amp;updateParts=itemLostDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_64', false)"><img src="/toread/images/lost_claim.gif" border="0" id="Any_13_8"></a></td></tr><tr height="20" style="color: black;" id="Any_9_10"><td class="black">10<strong>.</strong></td><td align="center"><input id="61962273" type="checkbox"></td><td align="center"><a id="DirectLink_65" title="Edit transaction" onclick="return createPopEdit(this.href);" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_8.sdirect?sp=l61962273">Borrow-day</a></td><td align="left"><a id="DirectLink_66" title="Circulation note" class="bluesimple" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_13.sdirect?sp=SED0123264&amp;updateParts=itemCircNoteDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_66', false)">ED0123264</a></td><td align="left">中文書</td><td align="left">552.337 8254 2018</td><td align="left">安定開架閱覽區[ED_B]</td><td align="center"></td><td align="left" width="110px"><span title="最低的水果摘完之後 =Once the lowest hanging fruit have been plucked /顏擇雅作臺北市 :天下雜誌出版 :2018.01" style="color: blue;" id="Insert_24_9">最低的水果摘完之後 =</span></td><td align="center" width="110px">2018-07-03 14:10:26</td><td align="center" width="110px">2018-07-17 23:59:59</td><td align="center" width="110px"></td><td align="center" width="110px"></td><td align="center"></td><td align="center">(0)<a id="DirectLink_67" title="續借" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_14.sdirect?sp=l61962273" onclick="return tapestry.linkOnClick(this.href,'DirectLink_67', false)"><img src="/toread/images/renew.gif" border="0" id="Any_11_9"></a><a id="DirectLink_68" title="還書" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_15.sdirect?sp=l61962273" onclick="return tapestry.linkOnClick(this.href,'DirectLink_68', false)"><img src="/toread/images/checkin.gif" border="0" id="Any_12_9"></a><a id="DirectLink_69" title="設定遺失或聲稱已還" href="/toread/circulation/pages/LoanDesk,PatronLoanDesk.TransactionsDesk.$circulation$components$ViewTransactions.$DirectLink_16.sdirect?sp=l61962273&amp;updateParts=itemLostDialog" onclick="return tapestry.linkOnClick(this.href,'DirectLink_69', false)"><img src="/toread/images/lost_claim.gif" border="0" id="Any_13_9"></a></td></tr>`